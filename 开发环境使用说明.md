# xPaste 开发环境使用说明

## 🚀 一键启动脚本

我们提供了多个脚本来简化开发环境的启动和管理。

### 启动脚本

#### 1. PowerShell 脚本 (推荐)
```powershell
.\start-dev.ps1
```

**功能特点：**
- ✅ 自动检查环境依赖 (pnpm, Go)
- ✅ 智能端口冲突检测和处理
- ✅ 实时启动状态监控
- ✅ 自动打开浏览器
- ✅ 详细的错误提示和故障排除建议
- ✅ 彩色输出，易于阅读

#### 2. 批处理脚本 (兼容性)
```cmd
start-dev.bat
```

**功能特点：**
- ✅ 基本环境检查
- ✅ 同时启动前后端服务
- ✅ 自动打开浏览器
- ✅ 简单易用

### 停止脚本

#### PowerShell 停止脚本
```powershell
.\stop-dev.ps1
```

**功能特点：**
- 🛑 智能检测并终止相关进程
- 🛑 按端口终止服务 (8080, 5173)
- 🛑 按进程名终止服务 (vite, go, pnpm, node)
- 🛑 终止 xPaste 相关窗口
- 🛑 最终状态验证

## 📱 服务信息

### 前端服务 (React + Vite)
- **端口**: 5173
- **地址**: http://localhost:5173
- **位置**: `apps/desktop/frontend/`
- **启动命令**: `cd apps/desktop && pnpm dev`

### 后端服务 (Go + Gin)
- **端口**: 8080
- **地址**: http://localhost:8080
- **位置**: `services/sync-api/`
- **启动命令**: `cd services/sync-api && pnpm dev`

## 🔧 环境要求

### 必需软件
- **Node.js** (v16+)
- **pnpm** (包管理器)
- **Go** (v1.19+)

### 安装命令
```bash
# 安装 pnpm
npm install -g pnpm

# 安装项目依赖
pnpm install
```

## 🎯 使用流程

### 1. 首次启动
```powershell
# 1. 安装依赖
pnpm install

# 2. 启动开发环境
.\start-dev.ps1
```

### 2. 日常开发
```powershell
# 启动
.\start-dev.ps1

# 停止 (可选，关闭终端窗口也会停止服务)
.\stop-dev.ps1
```

### 3. 手动启动 (如果脚本有问题)
```powershell
# 终端 1: 启动后端
cd services/sync-api
pnpm dev

# 终端 2: 启动前端
cd apps/desktop
pnpm dev
```

## 🔍 故障排除

### 常见问题

#### 1. 端口被占用
**现象**: 启动失败，提示端口已被使用
**解决**: 
- 运行 `.\stop-dev.ps1` 停止所有相关服务
- 或手动终止进程: `netstat -ano | findstr :8080`

#### 2. pnpm 未安装
**现象**: 提示 "pnpm 不是内部或外部命令"
**解决**: `npm install -g pnpm`

#### 3. Go 未安装
**现象**: 提示 "go 不是内部或外部命令"
**解决**: 从 https://golang.org/dl/ 下载安装 Go

#### 4. 依赖未安装
**现象**: 启动时出现模块找不到错误
**解决**: 在项目根目录运行 `pnpm install`

#### 5. PowerShell 执行策略限制
**现象**: 无法执行 .ps1 脚本
**解决**: 
```powershell
# 临时允许执行脚本
Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope CurrentUser

# 或者使用绕过策略运行
powershell -ExecutionPolicy Bypass -File .\start-dev.ps1
```

### 检查服务状态
```powershell
# 检查端口占用
netstat -ano | findstr :8080
netstat -ano | findstr :5173

# 检查进程
tasklist | findstr node
tasklist | findstr go
```

## 💡 开发提示

### 热重载
- **前端**: 修改 React 代码后自动重新加载
- **后端**: 修改 Go 代码后自动重新编译和重启

### 调试
- **前端**: 使用浏览器开发者工具
- **后端**: 查看终端输出的日志信息

### API 测试
- 后端 API 地址: `http://localhost:8080`
- 可以使用 Postman 或浏览器测试 API 接口

## 📞 获取帮助

如果遇到问题：
1. 查看终端窗口的错误信息
2. 检查上述故障排除部分
3. 确保所有依赖都已正确安装
4. 尝试重新启动服务

---

**祝你开发愉快！** 🎉
